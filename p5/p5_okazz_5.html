<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>p5</title>
    <!-- https://openprocessing.org/sketch/877402 -->
    <style>
        button {
            width: 10rem;
            height: 2rem;
        }

        input {
            width: 10rem;
            height: 2rem;
        }
    </style>
    <script src="ramda.js"></script>

    <script src="p5.js"></script>
    <!-- <script src="p5.createloop.js"></script> -->

    <!-- <script src="./allColors_10.js"></script> -->
    <meta charset="utf-8" />
</head>

<body>
    <script>

        const static = 800;
    let palette = ["#99ffff", "#ff99ff", "#ffda00", "#000000"];

    function setup() {
        createCanvas(static, static);
        noLoop();
        noStroke();
    }


            let cc = 30;
            // let cc = 50;
    function draw() {
        background("#72b972");

        let w = width / cc;
        for (let j = 0; j <= cc; j++) {
            for (let i = 0; i <= cc; i++) {
                let x = i * w;
                let y = j * w;
                fill(getCol());
                // disEllipse(x, y, w * 0.95, w * 1.5);
                disEllipse(x, y, w, w);
                fill(getCol());
                // disEllipse(x - w / 2, y - w * 1.4, w * 0.95, w * 1.5);
                disEllipse(x, y, w, w);
            }
        }
    }

let offAry=[];
    function distort(x, y) {
        let p = createVector(x, y);
        let scl = 0.0006;
        // scl = 0.001;
        let ang = noise(p.x * scl, p.y * scl) * 10;
        // let ang = random(p.x * scl, p.y * scl) * 10;
        // ang = noise(p.x * scl, p.y * scl) * 200;
        // let off = noise(p.x * scl, p.y * scl) * 100;
        let off = random(p.x * scl, p.y * scl) * 100;
        off = noise(p.x * scl, p.y * scl) * 100;
        // p.x += cos(ang) * off;
        // p.y += sin(ang) * off;
        offAry.push(off);
        p.x += cos(ang) * off;
        p.y += sin(ang) * off;
        // p.x += 1;
        // p.y += 1;
        return p;
    }

    function disEllipse(x, y, w, h) {
        beginShape();
        // for (let i = 0; i < TAU; i += TAU / 180) {
        for (let i = 0; i < TAU; i += TAU / 100) {
            let xx = x + w * 0.8 * cos(i);
            xx = x + w * 0.2 * cos(i);
            let yy = y + h * 0.8 * sin(i);
            yy = y + h * 0.2 * sin(i);
            let p = distort(xx, yy);
            curveVertex(p.x, p.y);
            // vertex(p.x, p.y);
        }
        endShape(CLOSE);
    }

    function getCol() {
        let col = random(palette);
        for (let i = 0; i < 5; i++) {
            if (col != "#ffda00") {
                col = random(palette);
            }
        }
        return col;
    }
    </script>
</body>

</html>