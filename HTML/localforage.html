<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>localforage</title>
        <!-- <script src="https://cdn.jsdelivr.net/npm/localforage@1.9.0/dist/localforage.min.js"></script> -->
        <script src="localforage.js"></script>
        <!-- https://github.com/localForage/localForage -->
        <!-- https://localforage.github.io/localForage/ -->

        <!-- https://github.com/taroyanaka/asset/blob/main/12152173513941/0 -->

        <!-- <script>console.log('localforage is: ', localforage);</script> -->
</head>
<body>
<textarea name="text" class="text" cols="30" rows="10"></textarea>
<button onclick="testSave(url);">testSave</button>
<button onclick="testLoad(url);">testLoad</button>
<button onclick="localforage.clear().then(function () {console.log('Database is now empty.')}).catch(function (err) {console.log(err)});">clear localForage</button>
<button onclick="other();">localForage other function</button>
<script>
    localforage.config({
        // bytes
        size: 524288000
        // => limit size 500MB
    });
</script>
<script>

const url = "https://raw.githubusercontent.com/taroyanaka/asset/main/12152173513941/0";

async function getData(url) {
    const response = await fetch(url);
    return await response.text();
}
async function testSave(url){
try {
    const data = await getData(url);
    await localforage.setItem(url, JSON.stringify(data));
    console.log("save success");
    } catch (err) {
    console.log(err);
    }
}
async function testLoad(url){
try {
    const value = await localforage.getItem(url);
    const res = value ? JSON.parse(value) : "db is null";
    document.querySelector(".text").value = res;
    } catch (err) {
    console.log(err);
    }
}
// function clear() {
    // localforage.clear().then(function () {console.log('Database is now empty.')}).catch(function (err) {console.log(err)});
// }
function other() {
    localforage.length().then(function (numberOfKeys) {
    document.querySelector(".text").value += numberOfKeys + "\n";
    }).catch(function (err) {
    document.querySelector(".text").value += err + "\n";
    });

    localforage.keys().then(function (keys) {
    document.querySelector(".text").value += keys + "\n";
    }).catch(function (err) {
    document.querySelector(".text").value += err + "\n";
    });
}
</script>
</body>
</html>