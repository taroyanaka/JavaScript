<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>namingTimer</title>
    <!-- https://github.com/validatorjs/validator.js -->
    <script src="./validator.13.7.0.min.js"></script>
    <style>
        button{
            width: 10rem;
            height: 2rem;
        }
        input{
            width: 30rem;
            height: 1.5rem;
        }
    </style>
</head>
<body>
<div class="result"></div>
<input type="number" name="seconds" class="seconds" placeholder="seconds" value="10" onchange="checkOfIntegerGreaterThanOrEqualTo1(event)" oninput="checkOfIntegerGreaterThanOrEqualTo1(event)">
<input type="text" name="name" class="name" placeholder="name alphanumeric 半角英数字">
<div>Timer is <span class="time"></span></div>
<button class="start" onclick="start()">start</button>
<button class="save" onclick="save()">save</button>
</body>
<script>
// https://github.com/typestack/class-validator/issues/10
const checkOfIntegerGreaterThanOrEqualTo1 = (event) => event.target.value = validator.isFloat(event.target.value, { min: 1 }) ? event.target.value : 1;
const getMinutes = (seconds) => parseInt(seconds / 60);
const getSeconds = (seconds) => parseInt(seconds % 60);
const getMinutesAndSecondsString = (minutes, seconds) => minutes.toString() + ":" + seconds.toString();
// https://stackoverflow.com/a/20618517
let intervalID;
const start = () => {
    const durationSeconds = parseInt(document.querySelector(`.seconds`).value, 10);
    let remainingSeconds = durationSeconds;
    try{clearInterval(intervalID)}
    catch(exception_var){console.log(exception_var)}
    finally{
        intervalID = setInterval(() => {
            document.querySelector('.time').textContent = getMinutesAndSecondsString(getMinutes(remainingSeconds), getSeconds(remainingSeconds));
            remainingSeconds = remainingSeconds <= 0 ? durationSeconds : remainingSeconds - 1;
        }, 1000);
    }
}
const set = (NUM) => document.querySelector(`.seconds`).value = parseInt(NUM, 10);
const load = (event) => set(Number(event.target.dataset.duration));



const save = () => {
    const numbering = "timer_" + document.querySelectorAll(".foo").length.toString();
    document.querySelector(`.result`).innerHTML += `<button data-duration="${document.querySelector(`.seconds`).value}" class="foo ${naming(numbering)}" onclick="load(event)">${document.querySelector(`.seconds`).value} ${naming(numbering)}</button>`;
}





const test = () => {
    document.querySelector(`.result`).innerHTML = `<button data-duration="3" class="foo timer_0" onclick="load(event)">3 timer_0</button>
<button data-duration="5" class="foo timer_1" onclick="load(event)">5 timer_1</button>`;
};
const test2 = () => {
    document.querySelector(`.timer_0`).click();
    document.querySelector(`.start`).click();
    document.querySelector(`.timer_1`).click();
    document.querySelector(`.start`).click();
    document.querySelector(`.seconds`).value = 0;
    save();
    document.querySelector(`.timer_2`).click();
    document.querySelector(`.start`).click();
    document.querySelector(`.seconds`).value = 1;
    save();
    document.querySelector(`.timer_3`).click();
    document.querySelector(`.start`).click();
    document.querySelector(`.seconds`).value = 5;
    save();
    document.querySelector(`.timer_4`).click();
    document.querySelector(`.start`).click();
};

const naming = (numbering) => validator.isAlphanumeric(document.querySelector(`.name`).value) ? document.querySelector(`.name`).value : numbering;


// test();
// test2();
</script>
</html>