<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>replacesql</title>
    <!-- https://docs.oracle.com/cd/B19306_01/server.102/b14195/sqlqr04.htm -->
    <style>
.selectableTextarea{
    display: flex;
    flex-wrap: wrap;

}
    </style>
</head>
<body>
<a href="" class="getParamFromschematablecolumn"></a>
<button onclick="exe();">exe</button>
<button onclick="makeFromSchema();">testSchema makeFromSchema</button>
<textarea name="" id="textarea-0" cols="30" rows="10"></textarea>
<textarea name="" id="textarea-1" cols="30" rows="10"></textarea>
<textarea name="" id="textarea-2" cols="30" rows="10">
SELECT * FROM table_name;
SELECT DISTINCT column_name;
SELECT column_name, column_name FROM table_name WHERE condition;
SELECT * FROM table_name WHERE condition AND condition;
SELECT * FROM table_name WHERE condition OR condition;
SELECT * FROM table_name WHERE NOT condition;
SELECT * FROM table_name WHERE condition AND (condition OR condition);
SELECT * FROM table_name WHERE EXISTS (SELECT column_name FROM table_name WHERE condition);
SELECT * FROM table_name ORDER BY column_name;
SELECT * FROM table_name ORDER BY column_name DESC;
SELECT * FROM table_name ORDER BY column_name ASC, column_name DESC;
SELECT TOP number columns_names FROM table_name WHERE condition;
SELECT * FROM Products WHERE (column_name BETWEEN value AND value) AND NOT column_name IN (value, value);
SELECT * FROM Products WHERE column_name BETWEEN value AND value;
SELECT * FROM table_name WHERE column_name IS NULL;
SELECT * FROM table_name WHERE column_name IS NOT NULL;
SELECT column_name AS alias_name FROM table_name;
SELECT column_name FROM table_name AS alias_name;
SELECT column_name AS alias_name, column_name AS alias_name;
SELECT column_name, column_name + ', ' + column_name AS alias_name;
SELECT column_name, COUNT(column_name) FROM table_name WHERE condition GROUP BY column_name ORDER BY
COUNT(column_name) DESC;
UPDATE table_name SET column_name = value, column_name = value WHERE condition;
UPDATE table_name SET column_name = value;
DELETE FROM table_name WHERE condition;
DELETE * FROM table_name;
SELECT COUNT (DISTINCT column_name);
SELECT AVG (column_name) FROM table_name WHERE condition;
SELECT SUM (column_name) FROM table_name WHERE condition;
SELECT columns_names FROM table_name WHERE column_name IN (value, value, …);
SELECT columns_names FROM table_name WHERE column_name IN (SELECT STATEMENT);
SELECT columns_names FROM table_name WHERE column_name BETWEEN value AND value;
SELECT MIN (columns_names) FROM table_name WHERE condition;
SELECT MAX (columns_names) FROM table_name WHERE condition;
SELECT columns_names FROM table_name INNER JOIN table_name ON table_name.column_name=table_name.column_name;
SELECT columns_names FROM table_name LEFT JOIN table_name ON table_name.column_name=table_name.column_name;
SELECT columns_names FROM table_name RIGHT JOIN table_name ON table_name.column_name=table_name.column_name;
SELECT columns_names FROM table_name FULL OUTER JOIN table_name ON table_name.column_name=table_name.column_name;
SELECT columns_names FROM table_name T1, table_name T2 WHERE condition;
SELECT table_name.column_name, table_name.column_name, table_name.column_name FROM ((table_name INNER JOIN table_name
ON relationship) INNER JOIN table_name ON relationship);
</textarea>
    <textarea class="upper" cols="30" rows="10"></textarea>
    <textarea class="lower" cols="30" rows="10"></textarea>
<div>
table_name:<div class="table_name_list"></div>
column_name:<div class="column_name_list"></div>
</div>

<div>
<span class="sqltext">SELECT * FROM table_name;</span>
</div>
<div>
<span class="sqltext">SELECT * FROM <select name="" id="">
        <option value=""></option>
        <option value="table_name">table_name</option>
        <option value="table_name">table_name</option>
        <option value="table_name">table_name</option>
    </select>;</span>
</div>
<div class="res"></div>
<div class="selectableTextarea"></div>

<!-- <div>
<span>SELECT column_name, column_name FROM table_name WHERE condition;</span>
</div>
<div>
<span class="sqltext">SELECT <select name="" id="">
        <option value=""></option>
        <option value="column_name">column_name</option>
        <option value="column_name">column_name</option>
        <option value="column_name">column_name</option>
    </select>, <select name="" id="">
        <option value=""></option>
        <option value="column_name">column_name</option>
        <option value="column_name">column_name</option>
        <option value="column_name">column_name</option>
    </select> FROM <select name="" id="">
        <option value=""></option>
        <option value="table_name">table_name</option>
        <option value="table_name">table_name</option>
        <option value="table_name">table_name</option>
    </select> WHERE <select name="" id="">
        <option value=""></option>
        <option value="condition">condition</option>
        <option value="condition">condition</option>
        <option value="condition">condition</option>
    </select>;</span>
</div>
<div> -->

<script>
const presetData = [
    ["actor", "film"],
    ["actor_name", "actor_id", "film_id", "film_name"]
]
const jsonparseAnyParam = (param) => JSON.parse((new URL(document.location)).searchParams.get(param));

const setDataToTextarea0 = () => document.querySelector(`#textarea-0`).value = (jsonparseAnyParam("table") || presetData[0] ).join("\n");
const setDataToTextarea1 = () => document.querySelector(`#textarea-1`).value = (jsonparseAnyParam("column") || presetData[1] ).join("\n");
setDataToTextarea0();
setDataToTextarea1();
const tableName = () => document.querySelector(`#textarea-0`).value.split("\n");
const columnName = () => document.querySelector(`#textarea-1`).value.split("\n");

function uniq(list) { list = list.map(V => { return JSON.stringify(V) }); return [...new Set(list)].map(V => { return JSON.parse(V) }) };

function range(from, to) { return [...Array(to - from)].reduce((A, V, IDX) => { A.push(from + IDX); return A }, A = []) };

function replaceTxt(txt) {
        return txt.replaceAll("(", " ")
        .replaceAll(")", " ")
        .replaceAll("=", " ")
        .replaceAll(";", " ")
        .replaceAll(";", " ")
        .replaceAll(".", " ")
        .replaceAll(",", " ")
        .replaceAll("'", " ")
}
function arrayUniqSortJoin(ary) {
    return uniq(ary).sort().join("\n");
}
function getUpper() {
    return uniq(document.querySelector(".upper").textContent
        .split("\n"))
        .filter(character => character !== "*");
}
function getLower() {
    return uniq(document.querySelector(".lower").textContent.split("\n"))
            .filter(character => character !== "+")
            .filter(character => character !== "…")
            .filter(character => character !== "*");
}
function exe2() {
    document.querySelector(".upper").textContent = getUpper().join("\n");
    document.querySelector(".lower").textContent = getLower().join("\n");
}

// https://stackoverflow.com/a/1027234
function exe() {
    const ary =
        replaceTxt(document.querySelector("#textarea-2").textContent).split(" ");
    document.querySelector(".upper").textContent =
        arrayUniqSortJoin(
            ary.filter(character => character == character.toUpperCase()) );
    document.querySelector(".lower").textContent =
        arrayUniqSortJoin(
            ary.filter(character => character == character.toLowerCase()) );
    exe2();
    makeSelectableTextarea();
    exe3();
}

function anyOptionTagString(anyAry) {
    return `<option value=""></option>` + anyAry.map(V => `<option value="${V}">${V}</option>`).join("")
}

function makeFromSchema() {
    document.querySelector(".table_name_list").innerHTML = `<select name="" id="tableName()">${anyOptionTagString(tableName())}</select>`;
    document.querySelector(".column_name_list").innerHTML = `<select name="" id="tableName()">${anyOptionTagString(columnName())}</select>`;
}
// makeFromSchema();

function setColumnsNamesMultipleSelectbox() {
    // Array.from(document.querySelector(".columns_names").selectedOptions)[0].value
    document.querySelector(".selectableTextarea").innerHTML += `columns_names:<select name="" class="columns_names" multiple>` + columnName().map(V => `<option value="${V}">${V}</option>`).join("") + `</select>`;
}
function makeTableAAndAIDBBndBID() {
    return `<select name="" class=""tableA relationship">` + tableName().map(V => `<option value="${V}">${V}</option>`) + `</select>`
    +
    `<select name="" class="tableAID relationship">` + columnName().map(V => `<option value="${V}">${V}</option>`) + `</select>`
    +
    `<select name="" class=""tableB relationship">` + tableName().map(V => `<option value="${V}">${V}</option>`) + `</select>`
    +
    `<select name="" class=""tableBID relationship">` + columnName().map(V => `<option value="${V}">${V}</option>`) + `</select>`
}
function setRelationshipMultipleSelectbox() {
    // Array.from(document.querySelector(".columns_names").selectedOptions)[0].value
    document.querySelector(".selectableTextarea").innerHTML += `relationship:` + makeTableAAndAIDBBndBID();
}
function setData() {
    document.querySelector(".alias_name").value =
        range(1, 10).map(V => "A" + V.toString() + "\n").join("");
    document.querySelector(".column_name").value =
        columnName().map(V => V.toString() + "\n").join("");
    document.querySelector(".condition").value = 
        ["=", "!=", "^=", "<>", ">", "<", ">=", "<=", "ANY", "SOME", "ALL" ,"LIKE", "NOT", "OR", "AND", "CASE WHEN condition1 THEN result1 WHEN conditionN THEN resultN ELSE result END", "IS NULL", "IS NOT NULL", "LIKE", "BETWEEN AND", "NOT BETWEEN", "IN ( expression_list | subquery )", "NOT IN ( expression_list | subquery )", "EXISTS (subquery)", "IS OF type", "IS EMPTY", "IS NOT EMPTY"].join("\n");
    document.querySelector(".number").value = 
         ["10", "30", "50", "100"].join("\n");

    document.querySelector(".table_name").value = 
        tableName().map(V => V.toString() + "\n").join("");
    document.querySelector(".value").value;
}

function makeSelectableTextarea() {
    setColumnsNamesMultipleSelectbox();
    setRelationshipMultipleSelectbox();
    document.querySelector(".selectableTextarea").innerHTML += `alias_name
column_name
condition
number
table_name
value`.split("\n").map(V=>`<div><div>${V}:</div><textarea name="" class="${V}" cols="30" rows="10" oninput="" placeholder="${V}"></textarea></div>`).join("");

    setData();
}

function exe3() {
    document.querySelector(".res").textContent =
        document.querySelector(".sqltext").textContent
            .replaceAll(";", " ;")
            .split(" ")
            .map(V => {
                    return getLower().slice(1).includes(V) ? "FOO" :  V;
            })
            .join(" ")
            .replaceAll(" ;", ";")
        ;
}

// window["FOO"]();
function FOO() {
    console.log("FOO");
}

const initHrefForschematablecolumn = () => {document.querySelector(".getParamFromschematablecolumn").textContent = window.location.origin + "/HTML/sql/schematablecolumn.html"; document.querySelector(".getParamFromschematablecolumn").href = window.location.origin + "/HTML/sql/schematablecolumn.html" }


makeFromSchema();
exe();


initHrefForschematablecolumn();
</script>
</body>
</html>