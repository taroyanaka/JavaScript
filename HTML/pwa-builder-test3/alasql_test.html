<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="./vue3.js"></script>
    <script src="./alasql.v1.7.3.js"></script>
    <title>alasql_test</title>
</head>
<body>
<div class="hoge">
    <input type="text" v-model="search" @input="filteredList">
    <div v-for="(item, index) in newPostList">
        <div>{{ item.article }}</div>
    </div>
</div>

<script>
    var app = new Vue({
        el: '#app',
        data: {
            search: '',
            newPostList: [],
        },
        methods: {
            filteredList: function () {
                var self = this;
                var search = this.search;
                var newPostList = alasql('SELECT * FROM ? WHERE article LIKE ?', [this.newPostList, '%' + search + '%']);
                this.newPostList = newPostList;
            },
            addPost: function (article) {
                this.newPostList.push({
                    article: article,
                    star_count: 0,
                    comment_count: 0,
                    article_length: article.length,
                    match_score: 0,
                });
            },
            removePost: function (index) {
                this.newPostList.splice(index, 1);
            },
            sortByStarCount: function () {
                this.newPostList.sort(function (a, b) {
                    return a.star_count - b.star_count;
                });
            },
            sortByCommentCount: function () {
alasql("CREATE TABLE example1 (a INT, b INT)");

// alasql's data store for a table can be assigned directly
alasql.tables.example1.data = [
    {a:2,b:6},
    {a:3,b:4}
];

// ... or manipulated with normal SQL
alasql("INSERT INTO example1 VALUES (1,5)");

var res = alasql("SELECT * FROM example1 ORDER BY b DESC");

console.log(res); // [{a:2,b:6},{a:1,b:5},{a:3,b:4}]

const hoge = Vue.createApp({
  data() {
    return {
      search: '',
      postList: article_lists.list,
      newPostList: article_lists.list,
    }
  },
  methods:{
    filteredList() {
      this.newPostList = this.postList.filter(post => {
        const all_comment_string = post.comment_list.map(V=>V.comment).join('');
        const article_with_all_comment_string = post.article + post.comment_list.map(V=>V.comment).join('');
        return article_with_all_comment_string.toLowerCase().includes(this.search.toLowerCase())
      });
    }
  }
}).mount(".hoge");
</script>
</body>
</html>