<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>make_better_sqlite3_code</title>
    <script src="./vue3.js"></script>
</head>
<body>
<div class="make_better_sqlite3_code">
    <textarea v-model="res" placeholder="res" name="res" id="res" cols="30" rows="10" @input="inputFn"></textarea>
    <input v-model="table_name" placeholder="table_name" type="text"></input>
    <textarea v-model="column_names" placeholder="column_names_one" name="column_names" id="column_names" cols="30" rows="10" @input="inputFn"></textarea>
    <!-- <p style="white-space: pre-line;">{{ res }}</p> -->
    <button @click="save">save</button>
    <!-- <button @click="comment_save">comment_save</button> -->
</div>
</body>
<script>
// table_name
// column_name

// select
// insert
// update
// delete
// create
// drop

const insert_initial_data = (table_name_key_value) => {
    const table_name = Object.keys(table_name_key_value)[0];
    const key_val = Object.values(table_name_key_value)[0];
    const KEY_VAL_PAIR = [key_val.map(V=>V[0]), key_val.map(V=>V[1])];
    const stmt = db.prepare(`INSERT INTO ${table_name} ( ${KEY_VAL_PAIR[0].join(", ")} ) VALUES (${KEY_VAL_PAIR[1].map(V=> "?").join(", ")})`);
    stmt.run(...KEY_VAL_PAIR[1]);
};


const template = {
select: `const SELECT = () => {
    try {
        return db.prepare('SELECT rowid, * FROM !!!THIS_IS_CHANGEABLE_TABLE_NAME!!!').all();
    } catch (ERROR) {
        return ERROR;
    }
};`,
insert: `const INSERT = () => {
    try {
        return db.prepare('INSERT INTO !!!THIS_IS_CHANGEABLE_TABLE_NAME!!! ( !!!THIS_IS_CHANGEABLE_COLUMN_NAMES!!! ) VALUES ( !!!THIS_IS_CHANGEABLE_COUPLE_OF_QUESTION_SYMBOLS!!! )').run( !!!THIS_IS_CHANGEABLE_VALUES_PARAMETERS!!! );
    } catch (ERROR) {
        return ERROR;
    }
};`,
update: ``,
delete: ``,
create: ``,
drop: ``,
};
const new_lined_string_to_join_comma_string = (new_lined_string) => new_lined_string.split("\n").join(", ");
const new_lined_string_to_question_symbol_comma_string = (new_lined_string) => new_lined_string.split("\n").map(V=> "?").join(", ");
const replace_string = (STR, FROM, TO) => STR.replaceAll(FROM, TO);
const make_better_sqlite3_code = Vue.createApp({
  data() {
    return {
      res: '',
      table_name: 'FOOBARBUZ',
      column_names: '',
    }
  },
  methods: {
    save() {
        // this.res = replace_string(template["select"], "!!!THIS_IS_CHANGEABLE_TABLE_NAME!!!", this.table_name);

        this.column_names = `FOO
BAR
BAZ`;
        let tmp = replace_string(template["insert"], "!!!THIS_IS_CHANGEABLE_TABLE_NAME!!!", this.table_name);
        tmp = replace_string(tmp, "!!!THIS_IS_CHANGEABLE_COLUMN_NAMES!!!", new_lined_string_to_join_comma_string(this.column_names));
        tmp = replace_string(tmp, "!!!THIS_IS_CHANGEABLE_COUPLE_OF_QUESTION_SYMBOLS!!!", new_lined_string_to_question_symbol_comma_string(this.column_names));
        this.res = tmp;
        
        // this.res = template["update"];
        // this.res = template["delete"];
        // this.res = template["create"];
        // this.res = template["drop"];
    },
    inputFn() {
      this.res = "res"
    },
},
}).mount('.make_better_sqlite3_code');
make_better_sqlite3_code.save();
</script>



<script>
const make_table_name_with_column_name = (TABLE_AND_COLUMN_NAMES) => TABLE_AND_COLUMN_NAMES[1].map(VAL=>TABLE_AND_COLUMN_NAMES[0] + '.' + VAL);
const article_lists_table_and_column_name = [
    "article_lists_table",
    [
        "id",
        "article",
        "search_txt",
        "sort_by",
        "sort_asc_or_desc",
        "editing",
        "star_count",
        "comment_count",
        "article_length",
        "match_score",
    ]
];
</script>
</html>