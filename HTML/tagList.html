<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tagList</title>
    <style>
        :root{
            --li-display: block;
        }
        li{
            list-style: none;
            display: block;
        }
        li.noShow{
            /* --li-display: none; */
            display: none;
        }
        /* .list{
            display: block;
        }
        .noList{
            display: none;
        } */
        span{
            margin: 1rem;
        }
    </style>
</head>
<body>
<button onclick="exe2()">exe2</button>
<input type="text" name="listName" class="listName"><span onclick="insertNewList()">+</span>
<input type="text" name="text" class="text">
<!-- <h1 class="foo"></h1> -->
<ul class="ul"></ul>
<script>
// document.querySelector('.foo').innerHTML = ['foo', 'bar', 'baz'].join(' ');
document.querySelector('.ul').innerHTML = 
    [
        `<li class="list"><span class="val">foo</span><span class="tag-parent"></span><span onclick="addTag(event)" class="tag-add">+</span></li>`,
        `<li class="list"><span class="val">bar</span><span class="tag-parent"></span><span onclick="addTag(event)" class="tag-add">+</span></li>`,
        `<li class="list"><span class="val">baz</span><span class="tag-parent"></span><span onclick="addTag(event)" class="tag-add">+</span></li>`,
    ]
    .join(' ');

const newListName = () => document.querySelector(`.listName`).value || document.querySelectorAll(`.list`).length;
const makeListHTML = () => `<li class="list"><span class="val">${newListName()}</span><span class="tag-parent"></span><span onclick="addTag(event)" class="tag-add">+</span></li>`;
const insertNewList = () => document.querySelector(`.ul`).innerHTML += makeListHTML();


// const addTag = (EVENT) => console.log(EVENT.target.previousElementSibling.outerHTML);

const addTag = (EVENT) => EVENT.target.previousElementSibling.innerHTML += `<span class="tag-child">${document.querySelector(`.text`).value}</span>`;

// const addTag = (e) => console.log(e.target);
// EVENT.target.previousElementSibling.innerHTML += `<span class="tag-child">${document.querySelector(`.text`).value}</span>`;
const tagOnly = () => document.querySelector(`.tag-add`).previousElementSibling.innerHTML += `<span class="tag-child">${document.querySelector(`.text`).value}</span>`;

function mergeAll(list){return Object.assign.apply({},[].concat(list))};
const exe = () => {
    return ["tag_0",
"tag_1",
"tag_3"]
.reduce((acc, cur) => {
    acc.push(Array.from(document.querySelectorAll(".tag-child")).filter(V=>V.textContent !== cur).map(V=>V.parentElement.parentElement));
    return acc;
}, []);
};

const tagFilter = () => mergeAll(exe());

const exe2 = () => {
    Array.from(document.querySelectorAll(".list")).forEach(V=>V.classList.add("noShow"));
    tagFilter().forEach(V=>V.classList.remove("noShow"));
};

// const tagNoFilter = () => Array.from(document.querySelectorAll(".tag-child"));

const init = () => {
    document.querySelector(`.listName`).value = "ThisIsListName";
    document.querySelector(`.text`).value = "tag_0";
};
init();
</script>
</body>
</html>