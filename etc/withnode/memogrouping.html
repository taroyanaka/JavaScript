<!DOCTYPE html>
<head>
<meta charset="UTF-8" />
<title>memo grouping</title>
<script src="ramda.min.js"></script>
</head>
<body>
	<div>
		<ul id="tag"></ul>
	</div>
	<div>
		<textarea name="foo" id="foo" cols="50" rows="10" required="required" autofocus="autofocus" placeholder="foo bar foo baz" onInput="makeList();"></textarea>
		<textarea name="foo1" id="foo1" cols="50" rows="10"></textarea>
	</div>
	<div>
		<textarea name="bar" id="bar" cols="20" rows="10"></textarea>
	</div>
<script>
let forConsoleDisplay;
let allText,allTag,allTextAndTag=[];

const exe = ()=>{
	const val0 = R.split("\n")(document.querySelector(`#foo`).value);
	const val1 = R.map(V=>{return R.split(" ",V)},val0);
	const val2 = [R.pluck(0,val1),R.map(V=>{return R.tail(V)},val1)];
	allTextAndTag = R.zip(val2[0],val2[1]);
	allText = R.pluck(0)(allTextAndTag);
	allTag = R.pipe(R.pluck(1),R.flatten,R.uniq)(allTextAndTag);
	document.querySelector(`#bar`).value = R.toString(allTextAndTag);
	forConsoleDisplay = R.clone(allTextAndTag);
}
const insertText=(event)=>{
	const val0 = R.filter(V=>R.includes(event.target.dataset.text,V[1]))(allTextAndTag);
	const val1 = R.map(V=>R.join(" ",R.flatten(V)))(val0);
	const val2 = R.join("\n")(val1);
	document.querySelector(`#foo1`).value = val2;
}
const makeLiTag = (array) => R.pipe(R.map(V=>{return `<li class="taglist" type="button" value='${V}' data-text='${V}' onclick="insertText(event)">${V}</li>`}), R.join(""))(array);
const addHTML = (htmlstring) =>	document.querySelector(`#tag`).insertAdjacentHTML(`beforeend`, htmlstring);
const makeList = ()=>{
		exe();
		console.table(forConsoleDisplay);
		document.querySelectorAll(".taglist").forEach(E=>{E.parentNode.removeChild(E)});
		addHTML(makeLiTag(allTag));
}

// when use develop for test--------------
let test;
let onlyExeTime=true;
test=true;
if(onlyExeTime&&test){
	document.querySelector(`#foo`).value =
`one foo
two bar
three bar
four foo baz
five baz
six bar baz`
	onlyExeTime=false;
}
// when use develop for test--------------

makeList();
</script>
</body>
</html>