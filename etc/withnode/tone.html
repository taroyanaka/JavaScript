<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <title>tonejs</title>

    <script src="./tone.js"></script>
</head>

<body>
    <!-- https://paiza.hatenablog.com/entry/2017/03/01/%E5%88%9D%E5%BF%83%E8%80%85%E3%81%A7%E3%82%82%E9%9F%B3%E6%A5%BD%E3%82%A2%E3%83%97%E3%83%AA%E3%81%8C%E4%BD%9C%E3%82%8C%E3%82%8B%EF%BC%81Web_Audio_API%E3%82%92%E7%B0%A1%E7%95%A5%E5%8C%96%E3%81%97%E3%81%9FJS -->
    <a>randome melody</a>
</body>
<script>
    // 配列シャッフル
    Array.prototype.shuffle = function () {
        var i = this.length;
        while (i) {
            var j = Math.floor(Math.random() * i);
            var t = this[--i];
            this[i] = this[j];
            this[j] = t;
        }
        return this;
    }



    // メロディの音符を配列で保持
    var melodyList = [
        'C4', 'D4', 'E4', 'F4',
        'G4', 'A4', 'B4', 'C5'
    ];
    melodyList.shuffle();
    var synth = new Tone.Synth().toMaster();

    function setPlay(time, note) {
        // 8分音符でメロディを発音
        synth.triggerAttackRelease(note, '8n', time);
    }
    // メロディをシーケンス制御する
    var melody = new Tone.Sequence(setPlay, melodyList).start();
    melody.loop = 1; // ループを1回に設定




    var melody2List = [
        'C2', 'D2', 'E2', 'F2',
        'G2', 'A2', 'B2', 'C3'
    ];
    var synth2 = new Tone.Synth().toMaster();

    function setPlay2(time, note) {
        synth2.triggerAttackRelease(note, '8n', time);
    }
    var melody2 = new Tone.Sequence(setPlay2, melody2List).start();
    melody2.loop = 1;




    Tone.Transport.bpm.value = 90; // BPMを90に設定
    Tone.Transport.start(); // 1小節分の時間をおいてから発音
</script>

</html>