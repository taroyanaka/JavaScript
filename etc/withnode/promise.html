<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<script src="ramda.min.js"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <!-- <title>Speech synthesiser</title> -->
    <title>neat reincarnation speaker</title>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
	<!-- https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis -->
	<!-- https://github.com/mdn/web-speech-api -->

	<!-- https://ncode.syosetu.com/n9669bk/ -->
	<!-- https://ncode.syosetu.com/ -->
  </head>
  <body>
	<p><a href="https://ncode.syosetu.com/n9669bk/">引用元: <cite>無職転生　- 異世界行ったら本気だす - 作者：理不尽な孫の手</cite></a></p>
	<select name="urlandtitle" id="urlandtitle" onInput="requestNEATAndInsertText();"></select>
    <!-- <form> -->
    <input type="text" class="txt">
    <div>
      <label for="rate">Rate</label><input type="range" min="0.5" max="2" value="1" step="0.1" id="rate">
      <div class="rate-value">1</div>
      <div class="clearfix"></div>
    </div>
    <div>
      <label for="pitch">Pitch</label><input type="range" min="0" max="2" value="1" step="0.1" id="pitch">
      <div class="pitch-value">1</div>
      <div class="clearfix"></div>
    </div>
    <select id="choosevoice"></select>
    <div class="controls">
      <button id="play" type="submit" onclick="play(event);">NEAT REINCARNATION!</button>
    </div>
    <!-- </form> -->
	<div id="resource"></div>
<script>

const returnURLWithQuery = () =>{
	return (
		"https://script.google.com/macros/s/AKfycbzbxLa2hfsBsFyvHxB4Q6RnLUHvpK8BvXIfU84f3hWGJXmN8PR4/exec"
		+ "?URL=" + encodeURIComponent(chooseTitleAndTheURL())
	)
}

const requestNEATAndInsertText = async () => {
	console.log("before");
	if( document.querySelector(`input.txt`).value ){
			document.querySelector("html > body > div#resource").parentNode.removeChild( document.querySelector("html > body > div#resource") );
			document.querySelector(`html > body`).insertAdjacentHTML(`beforeend`,  `<div id="resource"></div>` );
	}
	console.log("zero");
	const res = await fetch( returnURLWithQuery() );
	console.log("one");
	const text = await res.text();
	console.log("after");
	document.querySelector(`html > body > div#resource`).insertAdjacentHTML(`beforeend`,  text );
	document.querySelectorAll("html > body > div#resource").forEach(V=>{V.style="display:none"});
	document.querySelector(`input.txt`).value = document.querySelector(`#novel_honbun`).textContent;
}



function asyncFunction() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve("Async Hello world");
        }, 1000);
    });
}

const asyncFunction1 = async () => {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve("Async Hello world");
        }, 10000);
    });
}

asyncFunction().then((value) => {
    console.log(value); // => 'Async Hello world'
}).catch((error) => {
    console.error(error);
});

asyncFunction1().then((value) => {
    console.log(value); // => 'Async Hello world'
}).catch((error) => {
    console.error(error);
});


const outerAsyncFunction1 = async () => {
	const foo = await asyncFunction();
	const bar = await asyncFunction1();
	return  foo+" and "+bar;
}
outerAsyncFunction1().then((V)=>{
	console.log(V)
})

























document.querySelector("#choosevoice").value = "Kyoko (ja-JP) -- DEFAULT";
// requestNEATAndInsertText();
</script>
<style>
	body, html {
  margin: 0;
}

html {
  height: 100%;
}

body {
  height: 90%;
  max-width: 800px;
  margin: 0 auto;
}

h1, p {
  font-family: sans-serif;
  text-align: center;
  padding: 20px;
}

.txt, select, form > div {
  display: block;
  margin: 0 auto;
  font-family: sans-serif;
  font-size: 16px;
  padding: 5px;
}

.txt {
  width: 80%;
}

select {
  width: 83%;
}

form > div {
  width: 81%;
}

.txt, form > div {
  margin-bottom: 10px;
  overflow: auto;
}

.clearfix {
  clear: both;
}

label {
  float: left;
  width: 10%;
  line-height: 1.5;
}

.rate-value, .pitch-value {
  float: right;
  width: 5%;
  line-height: 1.5;
}

#rate, #pitch {
  float: right;
  width: 81%;
}

.controls {
  text-align: center;
  margin-top: 10px;
}

.controls button {
  padding: 10px;
}
</style>
</body>
</html>