<html>

<head>
    <style type="text/css">
        * {
            border: 0;
            margin: 0;
            padding: 0;
        }

        #drop_zone {
            border: 5px solid gray;
            width: 200px;
            height: 100px;
        }
    </style>
</head>

<body>
    <div>
        <img src="sizelogo.png" width="20" height="20" />
        <input id="size" type="range" max="12" min="3" step="3">
        <img src="playtimelogo.png" width="20" height="20" />
        <input id="playtime" type="range" max="100" min="0" step="5">
        <img src="looplogo.png" width="20" height="20" />
        <input id="loop" type="checkbox">
    </div>
    <div>
        <video class="video1" controls width="160" height="120" onmouseover="play()" onmouseout="pause()">
            <source src="4K_UHD_Drone_Portland_Oregon_Cherry_Blossoms_River_Bridge__Fernando.mp4"></video>
        <video class="video1" controls width="160" height="120" onmouseover="play()" onmouseout="pause()">
            <source src="Moving_Floor_V1_01.mp4"></video>
        <!-- <video class="video1" controls width="160" height="120" onmouseover="play()" onmouseout="pause()">
            <source src="CloseFallsTimelapse.mp4"></video>
        <video class="video1" controls width="160" height="120" onmouseover="play()" onmouseout="pause()">
            <source src="DockHdr.mp4"></video> -->
    </div>


    <div id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);">
        <p>Drag one or more video files to this Drop Zone</p>
    </div>
    <script>
        function resize() {
            const num = document.querySelector("#size").value * 10
            document.querySelectorAll("video").forEach(video => {
                video.width = (num * 4).toString();
                video.height = (num * 3).toString()
            })
        }
        document.querySelector("#size").addEventListener("change", resize, false);

        function playtime() {
            document.querySelectorAll("video").forEach(video => {
                video.currentTime = video.duration / 100 * document.querySelector("#playtime").value;
            })
        }
        document.querySelector("#playtime").addEventListener("change", playtime, false);

        function loop() {
            document.querySelectorAll("video").forEach(video => {
                video.loop = document.querySelector("#loop").checked;
            })
        }
        document.querySelector("#loop").addEventListener("change", loop, false);




















        function appendVideo(filesName) {
            for (let fileName of filesName) {
                let video = document.createElement("video");
                video.setAttribute("class", "video1");
                video.setAttribute("controls", false);
                video.setAttribute("width", "160");
                video.setAttribute("height", "120");
                video.setAttribute("onmouseover", "play()");
                video.setAttribute("onmouseout", "pause()");
                let source = document.createElement("source");
                source.setAttribute("src", fileName);
                video.appendChild(source);
                document.querySelector("body").appendChild(video);
            }
        }


        function dropHandler(ev) {
            console.log('File(s) dropped');

            ev.preventDefault();

            let filesName = [];
            if (ev.dataTransfer.items) {
                for (var i = 0; i < ev.dataTransfer.items.length; i++) {
                    if (ev.dataTransfer.items[i].kind === 'file') {
                        var file = ev.dataTransfer.items[i].getAsFile();
                        // console.log(let hoge = window.URL.createObjectURL(file));
                        // console.log('...file[' + i + '].name = ' + file.name);
                        // filesName.push(file.name);
                        filesName.push(window.URL.createObjectURL(file));
                    }
                }
            } else {
                for (var i = 0; i < ev.dataTransfer.files.length; i++) {
                    console.log('... file[' + i + '].name = ' + ev.dataTransfer.files[i].name);
                }
            }
            appendVideo(filesName);
            filesName = [];
        }

        function dragOverHandler(ev) {
            console.log('File(s) in drop zone'); // Prevent default behavior (Prevent file from being opened)
            ev.preventDefault();
        }
    </script>
</body>

</html>