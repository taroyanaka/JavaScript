<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vue list tag sample</title>
<script src="./vue@3.2.36.global.prod.js"></script>
<script src="./ramda.@0.28.0.js"></script>
</head>
<body>
<div class="app">
<li v-for="(item, index) in filter_tag">{{ item }}</li>
<li v-for="(item, index) in all_tag"><button @click="filter_by_tag(item)">{{ item }}</button><button @click="tag_delete_from_all_tag(item)">❎</button></li>
<input type="text" name="txt" class="txt" v-model="txt" minlength="1" maxlength="36" required>
<ul>
<li v-for="(item, index) in all_save">
{{ item[0] }} {{ item[1] }} {{ item[2] }} 
<!-- <li v-for="(TAG, TAG_INDEX) in (item[3].length > 0 ? item[3] : "")">{{TAG}}</li> -->
    <ul v-for="(TAG, TAG_INDEX) in (item[3].length > 0 ? item[3] : '')">
    <li><button @click="insert_to_txt(TAG)">{{ TAG }}</button></li>
    </ul>
<!-- {{ item[3].length > 0 ? item[3] : "" }} -->
<button @click="tag_set(item)">⭕️</button>
<button @click="tag_delete_from_list(item)">❎</button>
</li>
</ul>
</div>
</body>
<script>
const app = Vue.createApp({
    data() {
        return {
            txt: 'abc',
            all_tag: [],
            filter_tag: [],
            temporary_all_save: [],
            all_save: [
                [1,2,3, []],
                [4,5,6, []],
                [7,8,9, []],
            ],
        }
    },
    mounted() {
        this.temporary_all_save = this.all_save;
    },
    methods: {
        tag_delete_from_all_tag(ITEM){
            this.all_tag = R.without([ITEM], this.all_tag);
            this.all_save.forEach(V=>V[3] = R.without([ITEM], V[3]));
        },
        tag_delete_from_list(ITEM){
            ITEM[3] = R.without([this.txt], ITEM[3]);
        },
        insert_to_txt(ITEM){
            this.txt = ITEM;
        },
        tag_set(ITEM){
            if(this.txt === '') return false;

            this.all_tag.push(this.txt)
            this.all_tag = R.uniq(this.all_tag);
            ITEM[3].push(this.txt);
            this.all_save.forEach(V=>V[3] = R.uniq(V[3]));

            this.temporary_all_save = this.all_save;
        },
        filter_by_tag(ITEM){
            this.filter_tag.includes(ITEM) ? this.filter_tag = this.filter_tag.filter(V=>V!==ITEM) : this.filter_tag.push(ITEM);
            this.all_save = this.temporary_all_save.filter(VAL => {
                return VAL[3].some(V=>this.filter_tag.includes(V));
            });
            this.filter_tag.length === 0 ? this.all_save = this.temporary_all_save : null;
        },
    },
}).mount('.app');
</script>
</html>