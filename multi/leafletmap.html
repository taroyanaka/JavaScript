<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" /> -->
<link rel="stylesheet" href="./leaflet.css" />
<!-- <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script> -->
<script src="./leaflet@1.3.4.js"></script>
<script src="./vue@3.2.36.global.prod.js"></script>
<link rel="stylesheet" href="./cssui.min.css">
</head>
<body>
<div class="app">
<div id="mapid" style="height: 400px; width: 600px;"></div>
</div>
</body>
<script>
const app = Vue.createApp({
data() {
    return {
sample_data_ary: [
["東京都千代田区丸の内１丁目１−１", "サンプるの内"],
["東京都渋谷区宇田川町1-1", "shibuya city office"],
],
    }
},
beforeMounte(){
},
mounted() {
this.exe(...this.sample_data_ary[0]);
},
updated() {
},
methods: {
async get_data(PARAM_ADDRESS_STR){
    const res = await fetch("https://msearch.gsi.go.jp/address-search/AddressSearch?q="+encodeURIComponent(PARAM_ADDRESS_STR));
    const txt = await res.json();
    const data = await txt[0].geometry.coordinates;
    console.log(data);
    console.log(1);
    return data;
},
async exe(ADDRESS_STR, POPUP_STR){
    // const tmp_data = await get_data("東京都千代田区丸の内１丁目１−１");
    const tmp_data = await this.get_data(ADDRESS_STR);
function swap_array(array){
    let tmp = array[0];
    array[0] = array[1];
    array[1] = tmp;
    return array;
};
    const data = swap_array(tmp_data);
    // const data = [35.510281, 139.606164];
        console.log(2);
    var map = await L.map('mapid').setView(data, 16);
        console.log(3);
    await L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
        console.log(4);
    await L.marker(data).addTo(map)
        // .bindPopup('International Stadium Yokohama<br>横浜国際総合競技場')
        .bindPopup(POPUP_STR)
        .openPopup();
    console.log(5);
},
},
}).mount('.app');

</script>
</html>